@using Exam_Objective.Models
@using System.Collections.Generic

@{
    ViewBag.Title = "HardCopys";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var datahard = (List<HardCopyModel>)ViewBag.dataEx;
}

<div class="paddind-lr-30">
    <br />
    <span id="subj" data-subject="@datahard[0].SubjectID"></span>
    <span id="examt" data-examtopic="@datahard[0].ExamtopicID"></span>
    <span id="examb" data-exambody="@datahard[0].ExamBodyID"></span>
    <h4>ดาวน์โหลด Hard copy วิชา @ViewBag.dataSubject </h4>
    <h4>กลุ่มเรียน @ViewBag.dataGroup</h4>
    <hr />
    <p class="text-left">
        <button type="button" class="btn btn-default" onclick="window.history.back()"><span class="fa fa-reply"></span> ย้อนกลับ</button>
       
    </p><hr style="margin:2px;" />
    <br />
        <form id="hardcopyForm" method="post" class="form-horizontal">

            <div class="form-group">
                <label class="col-md-5 control-label"></label>
                <div class="col-md-5">
                    <button style="font-size:20px" title="กดเพื่อ ดาวน์โหลด" type="button" id="btnDownl" class="btn btn-primary btnDownl"><span class="fa fa-download"></span> ข้อสอบ</button>
                    <button style="font-size:20px" title="กดเพื่อ ดาวน์โหลด" type="button" id="btnDownls" class="btn btn-primary btnDownls"><span class="fa fa-download"></span> เฉลย</button>
                </div>
            </div>

        </form>
    @* <h3>ระบุรายละเอียดเพิ่มเติมข้อสอบ</h3>
        <br />
            <form id="hardcopyForm" method="post" class="form-horizontal">
                <div class="form-group">
                    <label class="col-md-3 control-label">ชื่อสถาบัน:<span style="color:red"> *</span></label>
                    <div class="col-md-5">
                        <input type="text" class="form-control" name="" id="" />
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-3 control-label">อาจารย์ผู้สอน:<span style="color:red"> *</span></label>
                    <div class="col-md-5">
                        <input type="text" class="form-control" name="" id="" />
                    </div>
                </div>
                <div class="form-group" >
                    <label class="col-md-5 control-label"></label>
                    <div class="col-md-5">
                        <button type="button" id="btnSave" class="btn btn-primary btnSave">บันทึก</button>
                    </div>
                </div>

            </form>*@
</div>
@section scripts{
<script type="text/javascript">
    var data1 = {
        ExamtopicID: $('#examt').data("examtopic"),
        SubjectID: $('#subj').data("subject"),
        ExamBodyID: $('#examb').data("exambody")
    };
    $('#btnDownl').click(function () {
        data1.ExamtopicID = $('#examt').data("examtopic");
        data1.SubjectID = $('#subj').data("subject");
        data1.ExamBodyID = $('#examb').data("exambody");
         $.ajax({
            type: "POST",            
            cache: false,
            url: "ExportDoc",
             dataType: "json",
             data: data1,
            traditional: true,
            beforeSend: function () {

        },

        success: function (res) {
            var filename = "";
            var message = 'ดำเนินการไม่สำเร็จ';
            if (res != null && res != undefined) {
                status = res.fileName;
                message = res.message != '' ? res.message : message;
            }
            if (res.fileName != "") {
                //use window.location.href for redirect to download action for download the file
                window.location.href = "@Url.RouteUrl(new
            { Controller = "Testing", Action = "Download"})/?file=" + res.fileName;
            } else {
               // alert(res.message);
            }
        },
        error: function (xhr, ajaxOption, thrownError) {
            swal("เกิดข้อผิดพลาด", message, "error");
        },
        complete: function () {

        }
    });
    });

     $('#btnDownls').click(function () {
        data1.ExamtopicID = $('#examt').data("examtopic");
        data1.SubjectID = $('#subj').data("subject");
        data1.ExamBodyID = $('#examb').data("exambody");
         $.ajax({
            type: "POST",            
            cache: false,
            url: "ExportDocans",
             dataType: "json",
             data: data1,
            traditional: true,
            beforeSend: function () {

        },

        success: function (res) {
            var filename = "";
            var message = 'ดำเนินการไม่สำเร็จ';
            if (res != null && res != undefined) {
                status = res.fileName;
                message = res.message != '' ? res.message : message;
            }
            if (res.fileName != "") {
                //use window.location.href for redirect to download action for download the file
                window.location.href = "@Url.RouteUrl(new
            { Controller = "Testing", Action = "Download"})/?file=" + res.fileName;
            } else {
               // alert(res.message);
            }
        },
        error: function (xhr, ajaxOption, thrownError) {
            swal("เกิดข้อผิดพลาด", message, "error");
        },
        complete: function () {

        }
    });
    });
   

</script>
    }